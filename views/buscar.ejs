<%- include('partials/header') %>

<body>
    <div class="page">
        <%- include('partials/navbar') %>

        <!-- CONTEÚDO PRINCIPAL -->
        <div class="container d-flex flex-column">
            <%- include('partials/breadcrumb') %>
            <div class="row infos-resultados">
                <div class="resultado-busca">
                    <strong><%= search %></strong>
                    <p>(<%= quantidade %> produtos encontrados)</p>
                </div>
                <div class="select-ordenar d-flex flex-column">
                    <label>Ordenar por</label>
                    <select name="ordenar" id="ordenar" class="submit-on-change">
                        <option value="">Todos os produtos</option>
                        <option value="">Menor Preço</option>
                        <option value="">Maior Preço</option>
                    </select>
                </div>
            </div>
            <div class="row produtos-busca">
                <% for (produto of resultado) { %>
                <card class="anuncio-box card shadow">
                    <a href="#"><img src="/images/mesversario.png" alt="" class="img-fluid"></a>
                    <titulo class="card-text"><%= produto.nome %></titulo>
                    <div>
                        <span>Avaliação: <b><%= produto.avaliacao %></b></span>
                        <preco>R$<%= produto.valor.toFixed(2) %></preco>
                    </div>
                    <a href="#">Saiba Mais...</a>
                </card>
                <% } %>
            </div>
            <p>Exibindo <%= resultado.length %> de <%= quantidade %> resultados.</p>
            <div class="row lista-paginas">
                <% if(pageActual > 1) { %>
                <a href="/produtos/buscar?search=<%= search %>&page=<%= (Number(pageActual) - 1) %>">
                    <img src="/images/previous-page.png" alt="Ir para a página anterior.">
                </a>
                <% } %>
                <% let inicio; let fim; %>
                <% (pageActual <= 3) ? inicio = 1 : inicio = Math.max(1, Math.min((pageActual - 2), (totalPage - 4))) %>
                <% (pageActual <= 3) ? fim = Math.min(5, totalPage) : fim = Math.min((pageActual + 2), totalPage) %>
                <% for (let i = inicio; i <= fim; i++) { %>
                <% if (i == pageActual) { %>
                <a class="active" href="/produtos/buscar?search=<%= search %>&page=<%= i %>"><%= i %></a>
                <% } else { %>
                <a href="/produtos/buscar?search=<%= search %>&page=<%= i %>"><%= i %></a>
                <% } %>
                <% } %>
                <% if(pageActual < totalPage) { %>
                <a href="/produtos/buscar?search=<%= search %>&page=<%= (Number(pageActual) + 1) %>">
                    <img src="/images/next-page.png" alt="Ir para a página posterior.">
                </a>
                <% } %>
            </div>
        </div>
    </div>
    <%- include('partials/footer') %>
    <%- include('partials/script') %>
</body>